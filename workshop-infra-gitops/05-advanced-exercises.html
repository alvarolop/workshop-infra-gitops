<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>5. Advanced Exercises :: GitOps Infrastructure Configuration Workshop</title>
    <link rel="canonical" href="https://alvarolop.github.io/workshop-infra-gitops/index.html/workshop-infra-gitops/05-advanced-exercises.html">
    <link rel="prev" href="04-day2-config.html#daytwooperations">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../_/img/RHDLogo.svg" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://alvarolop.github.io/workshop-infra-gitops/index.html">GitOps Infrastructure Configuration Workshop</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kafka-tutorial/" target="_blank">Kafka</a>
            <a class="navbar-item" href="https://devsecops-workshop.github.io/" target="_blank">DevSecOps</a>
            <a class="navbar-item" href="https://acidonper.github.io/redhat-workshop-cicd-gitops/redhat-workshop-cicd-gitops/" target="_blank">CI/CD & GitOps</a>
            <a class="navbar-item" href="https://atarazana.github.io/gramola-gitops-guide/gramola-gitops-guide/" target="_blank">Gramola GitOps Guide</a>
            <a class="navbar-item" href="https://luisarizmendi.github.io/tutorial-secure-onboarding/" target="_blank">Secure Edge device onboarding with RHEL and FDO</a>
            <a class="navbar-item" href="https://xbryan1.github.io/rhte-2023-acm-docs/" target="_blank">Multicluster Application Deployment with Advanced Cluster Management and GitOps</a>
            <a class="navbar-item" href="https://redhat-scholars.github.io/java-inner-loop-dev-guide/java-inner-loop-dev-guide/index.html" target="_blank">Java Inner Loop Dev Guide</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="workshop-infra-gitops" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Table of Contents</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="01-setup.html">1. Environment Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#prerequisite">1.1 Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#gettutorialsources">1.2 Get tutorial sources</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-hub-setup.html">2. Deploy Argo Hub Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-hub-setup.html#laboverview">2.1 Lab overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-hub-setup.html#environment">2.2 Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-hub-setup.html#argohub">2.3 Accessing the Argo Hub</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-hub-setup.html#hubsetup">2.4 Overview of the Hub Setup Application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-hub-setup.html#managed">2.5 Accessing the Managed Cluster</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-sno-setup.html">3. Deploy Managed Cluster Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-sno-setup.html#managedconfiguration">3.1. Managed Cluster Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-sno-setup.html#helmcharts">3.2. Helm Charts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-sno-setup.html#triggergitops">3.3 Trigger the GitOps configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-sno-setup.html#vaultapp">3.4 Creating your first ArgoCD Apps application</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-day2-config.html#daytwooperations">4. Day 2 Operations</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-day2-config.html#identityproviders">4.1 Configure Identity Providers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-day2-config.html#deployoperators">4.2 Deploy Operators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-day2-config.html#namespace">4.3 Namespace Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-day2-config.html#monitoring">4.4 Configure Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-day2-config.html#vault">4.5 Vault Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-day2-config.html#appset">4.6 Day 2 with ApplicationSet</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-day2-config.html#summary">4.7 Summary</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="05-advanced-exercises.html">5. Advanced Exercises</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">GitOps Infrastructure Configuration Workshop</a></li>
    <li><a href="05-advanced-exercises.html">5. Advanced Exercises</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/alvarolop/workshop-infra-gitops/edit/master/documentation/modules/ROOT/pages/05-advanced-exercises.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">5. Advanced Exercises</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>If you found the proposed exercises in this workshop too straightforward or relied too heavily on copy-paste steps, you&#8217;re in luck. These advanced exercises require you to work independently to achieve the desired outcomes.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_5_1_certificates_with_cert_manager"><a class="anchor" href="#_5_1_certificates_with_cert_manager"></a>5.1 Certificates with cert-manager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By now, you may have noticed a significant difference between the <code>argo-hub</code> cluster and the <code>sno-XX</code> clusters regarding certificates. The <code>argo-hub</code> cluster uses certificates with a proper Certificate Authority (CA) chain issued by Let&#8217;s Encrypt, while the <code>sno-XX</code> clusters rely on default self-signed certificates from the installation process. This approach is not suitable for production environments, as it can raise concerns about potential Man-in-the-Middle (MitM) attacks.</p>
</div>
<div class="paragraph">
<p>In this exercise, you will explore the benefits of using the cert-manager operator. You will configure it to automatically generate and manage two types of certificates, integrating them into your OpenShift GitOps configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>API Certificate</strong>: This certificate will provide secure access to your cluster&#8217;s API, ensuring that all communication between clients and the API server is encrypted and authenticated. This is crucial for maintaining the integrity and confidentiality of cluster operations.</p>
</li>
<li>
<p><strong>Ingress Certificate</strong>: This certificate will be used for securing ingress traffic to your cluster. It will be a wildcard certificate, meaning it can secure multiple subdomains under a single domain (e.g., *.example.com). This allows you to manage a single certificate for multiple services or applications hosted within your cluster, simplifying certificate management and ensuring that all incoming traffic is encrypted.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Steps to Complete</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install cert-manager: Deploy the cert-manager operator in your cluster.</p>
</li>
<li>
<p>Configure Certificate Issuers: Set up certificate issuers for Let&#8217;s Encrypt or another preferred CA.</p>
</li>
<li>
<p>Create Certificate Requests: Define certificate requests for both the API and Ingress certificates.</p>
</li>
<li>
<p>Integrate with OpenShift GitOps: Configure your GitOps setup to use these certificates for secure API and ingress traffic.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This exercise will help you understand how to automate certificate management in a production-ready environment, enhancing the security and reliability of your OpenShift cluster.</p>
</div>
<div class="paragraph">
<p>If you want to look for information, I recommend you to get inspired by the following sources of information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Documentation <a href="https://docs.redhat.com/en/documentation/openshift_container_platform/4.17/html/security_and_compliance/cert-manager-operator-for-red-hat-openshift#cert-manager-operator-about">cert-manager Operator for Red Hat OpenShift</a>.</p>
</li>
<li>
<p>GitHub repository <a href="https://github.com/alvarolop/ocp-secured-integration?tab=readme-ov-file#2-cert-manager">alvarolop/ocp-secured-integration</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Please, try to do some research before keep reading!!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Ok, maybe it was too difficult, as I didn&#8217;t give you any code example, so let&#8217;s try to split this task in small pieces.</p>
</div>
<div class="sect2">
<h3 id="_hint_1_the_operator"><a class="anchor" href="#_hint_1_the_operator"></a>Hint 1: The operator</h3>
<div class="paragraph">
<p>As there could be some version dependencies in the cluster and you only want to install the operator once, but use it from several application or teams, it is a common practice to centralize the installation of operators in a different application. That is the reason why we have the <code>sno-XX-operators</code> application.</p>
</div>
<div class="paragraph">
<p>Please, add the cert-manager operator to the Helm Chart and make sure that the operator is installed after syncing the app again!!</p>
</div>
</div>
<div class="sect2">
<h3 id="_hint_2_the_cert_manager_files"><a class="anchor" href="#_hint_2_the_cert_manager_files"></a>Hint 2: The cert-manager files</h3>
<div class="paragraph">
<p>Once you have the operator installed, you will need to add several configuration files to the <code>helm-infra-gitops-workshop</code>. Best practice is to create a new ArgoCD application, a new folder and a new values file. So let&#8217;s do it!!</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The folder should be named <code>cert-manager</code> and contain the structure of a Helm Chart. Inside the <code>templates</code> folder you will have the files from the next hints. Yo can keep it empty now.</p>
</li>
<li>
<p>Create a <code>values-cert-manager.yaml</code> file with a boilerplate content like:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">cert-manager:
  enabled: true</code></pre>
</div>
</div>
</li>
<li>
<p>Push it</p>
</li>
<li>
<p>Create an ArgoCD application pointing to that path and check that the Application is Healthy, despite is doesn&#8217;t create any new resource on the cluster.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_hint_3_the_cert_manager_configuration"><a class="anchor" href="#_hint_3_the_cert_manager_configuration"></a>Hint 3: The cert-manager configuration</h3>
<div class="paragraph">
<p>Now, it&#8217;s time to actually add the cert-manager configuration, which can be split in a few steps:</p>
</div>
<div class="paragraph">
<p>*</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="04-day2-config.html#daytwooperations">4. Day 2 Operations</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
